var child_process = require('child_process');

function debug(msg) {
    if (exports.DEBUG) {
        console.log(msg);
    }
}

function sequential_commands(cwd, commands, callback) {
    commands = Array.prototype.slice.call(commands);
    function next() {
        if (!commands.length) {
            callback();
        } else {
            var command = commands.shift();
            debug('$ ' + command.cmd + ' ' + command.args.join(' '));
            var child = child_process.spawn(command.cmd, command.args, {cwd: cwd, stdio: [null, process.stdout, process.stderr]});//'ignore'});
            child.on('exit', next);
        }
    }
    next();
}

exports.sequential_commands = sequential_commands;
exports.debug = debug;